import{c as Y,r as t,p as M,t as n,j as e,C as o,h as j,i as u,g as x,k as _,B as h,I as L,S as O,l as z,m as B,n as V,o as c,L as R,U as ye}from"./index-GVDjicHU.js";import{U as J,P as Ne,T as ve,S as we,a as be,M as Se,b as Ce}from"./sheet-wigWzPHD.js";import{B as Ae,f as N,p as Ue,D as ee,d as se,e as ae,g as te,h as re,q as De,s as le,j as Te,k as Ee,R as ke,l as Re,P as ne,a as ce,C as ie,b as de,c as oe,m as Me,S as $e,T as Fe,L as xe,o as Pe,n as Ie,U as Le}from"./ProfileTab-CFTUsnsI.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],Oe=Y("search",_e);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],H=Y("user-check",ze);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Ve=Y("user-plus",Be);function qe({accessToken:v}){const[a,w]=t.useState([]),[b,y]=t.useState([]),[p,U]=t.useState(!1),[r,E]=t.useState(""),[m,q]=t.useState("ALL"),[S,D]=t.useState(null),[K,C]=t.useState(!1),[$,T]=t.useState(!1),[i,f]=t.useState(""),[l,g]=t.useState(""),[F,Q]=t.useState(""),[k,W]=t.useState(""),[G,X]=t.useState("STUDENT");t.useEffect(()=>{P()},[]),t.useEffect(()=>{he()},[a,r,m]);const P=async()=>{U(!0);try{const s=await fetch(`https://${M}.supabase.co/functions/v1/make-server-493cc528/admin/users`,{headers:{Authorization:`Bearer ${v}`}});if(s.ok){const d=await s.json();w(d)}else{const d=await s.json();n.error(`Failed to fetch users: ${d.error}`)}}catch(s){console.error("Error fetching users:",s),n.error("An error occurred while fetching users")}finally{U(!1)}},he=()=>{let s=a;if(m!=="ALL"&&(s=s.filter(d=>d.role===m)),r){const d=r.toLowerCase();s=s.filter(A=>A.name.toLowerCase().includes(d)||A.email.toLowerCase().includes(d))}y(s)},me=async()=>{if(!(!S||!i))try{const s=await fetch(`https://${M}.supabase.co/functions/v1/make-server-493cc528/admin/users/${S.id}`,{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify({role:i})});if(s.ok)n.success("User role updated successfully!"),P(),C(!1),D(null),f("");else{const d=await s.json();n.error(`Update failed: ${d.error}`)}}catch(s){console.error("Error updating user role:",s),n.error("An error occurred while updating user")}},je=async()=>{if(!l.trim()||!F.trim()||!k.trim()){n.error("Please fill in all required fields");return}if(k.length<6){n.error("Password must be at least 6 characters");return}try{const s=await fetch(`https://${M}.supabase.co/functions/v1/make-server-493cc528/admin/users`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${v}`},body:JSON.stringify({email:F.trim(),password:k,name:l.trim(),role:G})});if(s.ok)n.success("User created successfully!"),P(),Z(),T(!1);else{const d=await s.json();n.error(`Failed to create user: ${d.error}`)}}catch(s){console.error("Error creating user:",s),n.error("An error occurred while creating user")}},ue=async(s,d)=>{if(confirm(`Are you sure you want to delete user "${d}"? This action cannot be undone.`))try{const A=await fetch(`https://${M}.supabase.co/functions/v1/make-server-493cc528/admin/users/${s}`,{method:"DELETE",headers:{Authorization:`Bearer ${v}`}});if(A.ok)n.success("User deleted successfully!"),P();else{const fe=await A.json();n.error(`Delete failed: ${fe.error}`)}}catch(A){console.error("Error deleting user:",A),n.error("An error occurred while deleting user")}},Z=()=>{g(""),Q(""),W(""),X("STUDENT")},ge=s=>{D(s),f(s.role),C(!0)},pe=s=>({STUDENT:"bg-blue-100 text-blue-800",CAFETERIA_ADMIN:"bg-purple-100 text-purple-800",SYSTEM_ADMIN:"bg-red-100 text-red-800"})[s]||"bg-gray-100 text-gray-800",I={total:a.length,students:a.filter(s=>s.role==="STUDENT").length,cafeteriaAdmins:a.filter(s=>s.role==="CAFETERIA_ADMIN").length,systemAdmins:a.filter(s=>s.role==="SYSTEM_ADMIN").length};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-4",children:[e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm",children:"Total Users"}),e.jsx(J,{className:"w-4 h-4 text-gray-500"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-orange-600",children:I.total})})]}),e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm",children:"Students"}),e.jsx(H,{className:"w-4 h-4 text-gray-500"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-blue-600",children:I.students})})]}),e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm",children:"Cafeteria Admins"}),e.jsx(H,{className:"w-4 h-4 text-gray-500"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-purple-600",children:I.cafeteriaAdmins})})]}),e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm",children:"System Admins"}),e.jsx(H,{className:"w-4 h-4 text-gray-500"})]}),e.jsx(x,{children:e.jsx("div",{className:"text-red-600",children:I.systemAdmins})})]})]}),e.jsxs(o,{children:[e.jsx(j,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx(u,{children:"User Management"}),e.jsx(_,{children:"Manage user accounts and roles"})]}),e.jsxs(h,{onClick:()=>T(!0),className:"bg-orange-500 hover:bg-orange-600 gap-2 w-full sm:w-auto",size:"sm",children:[e.jsx(Ve,{className:"w-4 h-4"}),"Create User"]})]})}),e.jsxs(x,{children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Oe,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx(L,{placeholder:"Search by name or email...",value:r,onChange:s=>E(s.target.value),className:"pl-10"})]}),e.jsxs(O,{value:m,onValueChange:q,children:[e.jsx(z,{className:"w-full sm:w-[200px]",children:e.jsx(B,{})}),e.jsxs(V,{children:[e.jsx(c,{value:"ALL",children:"All Roles"}),e.jsx(c,{value:"STUDENT",children:"Students"}),e.jsx(c,{value:"CAFETERIA_ADMIN",children:"Cafeteria Admins"}),e.jsx(c,{value:"SYSTEM_ADMIN",children:"System Admins"})]})]})]}),p?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin"})}):b.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No users found"})}):e.jsx("div",{className:"space-y-3",children:b.map(s=>e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors gap-3",children:[e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-orange-400 to-orange-600 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white",children:s.name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"truncate",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 truncate",children:s.email})]})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-4",children:[e.jsxs("div",{className:"text-left sm:text-right",children:[e.jsx(Ae,{className:pe(s.role),children:s.role.replace("_"," ")}),s.createdAt&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1 whitespace-nowrap",children:["Joined ",N(Ue(s.createdAt),"MMM d, yyyy")]})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>ge(s),className:"gap-2",children:[e.jsx(Ne,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),e.jsxs(h,{variant:"outline",size:"sm",onClick:()=>ue(s.id,s.name),className:"text-red-600 hover:text-red-700",children:[e.jsx(ve,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Delete"})]})]})]})]},s.id))})]})]}),e.jsx(ee,{open:$,onOpenChange:T,children:e.jsxs(se,{children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Create New User"}),e.jsx(re,{children:"Add a new user to the MealPal system"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"new-user-name",children:"Full Name *"}),e.jsx(L,{id:"new-user-name",value:l,onChange:s=>g(s.target.value),placeholder:"John Doe"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"new-user-email",children:"Email *"}),e.jsx(L,{id:"new-user-email",type:"email",value:F,onChange:s=>Q(s.target.value),placeholder:"john.doe@example.com"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"new-user-password",children:"Password *"}),e.jsx(L,{id:"new-user-password",type:"password",value:k,onChange:s=>W(s.target.value),placeholder:"Minimum 6 characters"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"new-user-role",children:"Role *"}),e.jsxs(O,{value:G,onValueChange:X,children:[e.jsx(z,{id:"new-user-role",children:e.jsx(B,{})}),e.jsxs(V,{children:[e.jsx(c,{value:"STUDENT",children:"Student"}),e.jsx(c,{value:"CAFETERIA_ADMIN",children:"Cafeteria Admin"}),e.jsx(c,{value:"SYSTEM_ADMIN",children:"System Admin"})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(h,{onClick:je,className:"flex-1 bg-orange-500 hover:bg-orange-600",disabled:!l||!F||!k,children:"Create User"}),e.jsx(h,{variant:"outline",onClick:()=>{T(!1),Z()},children:"Cancel"})]})]})]})}),e.jsx(ee,{open:K,onOpenChange:C,children:e.jsxs(se,{children:[e.jsxs(ae,{children:[e.jsx(te,{children:"Edit User Role"}),e.jsxs(re,{children:["Change the role for ",S?.name]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"User"}),e.jsx("p",{children:S?.name}),e.jsx("p",{className:"text-sm text-gray-500",children:S?.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(R,{htmlFor:"new-role",children:"New Role"}),e.jsxs(O,{value:i,onValueChange:f,children:[e.jsx(z,{id:"new-role",children:e.jsx(B,{})}),e.jsxs(V,{children:[e.jsx(c,{value:"STUDENT",children:"Student"}),e.jsx(c,{value:"CAFETERIA_ADMIN",children:"Cafeteria Admin"}),e.jsx(c,{value:"SYSTEM_ADMIN",children:"System Admin"})]})]})]}),e.jsxs("div",{className:"flex gap-2 pt-4",children:[e.jsx(h,{onClick:me,className:"flex-1 bg-orange-500 hover:bg-orange-600",children:"Update Role"}),e.jsx(h,{variant:"outline",onClick:()=>{C(!1),D(null),f("")},children:"Cancel"})]})]})]})})]})}function Ke({accessToken:v}){const[a,w]=t.useState(null),[b,y]=t.useState(!1),[p,U]=t.useState("all"),[r,E]=t.useState(),[m,q]=t.useState(),[S,D]=t.useState(!1),[K,C]=t.useState(!1);De(new Date),t.useEffect(()=>{$()},[p,r,m]);const $=async()=>{y(!0);try{let i=`https://${M}.supabase.co/functions/v1/make-server-493cc528/admin/analytics`;if(p==="custom"&&r&&m)i+=`?startDate=${N(r,"yyyy-MM-dd")}&endDate=${N(m,"yyyy-MM-dd")}`;else if(p!=="all"){const l=new Date;let g;switch(p){case"today":g=l;break;case"week":g=Ee(l);break;case"month":g=Te(l);break;case"7days":g=le(l,7);break;case"30days":g=le(l,30);break;default:g=l}i+=`?startDate=${N(g,"yyyy-MM-dd")}&endDate=${N(l,"yyyy-MM-dd")}`}const f=await fetch(i,{headers:{Authorization:`Bearer ${v}`}});if(f.ok)w(await f.json());else{const l=await f.json();n.error(`Failed to fetch analytics: ${l.error}`)}}catch{n.error("An error occurred while fetching analytics")}finally{y(!1)}},T=()=>{if(!a)return n.error("No data to export");const i=[["MealPal Analytics Report"],["Generated:",new Date().toLocaleString()],["Date Range:",p],[],["Metric","Value"],["Total Users",a.totalUsers],["Students",a.totalStudents],["Cafeteria Admins",a.totalCafeteriaAdmins],["System Admins",a.totalSystemAdmins],["Total Transactions",a.totalTransactions],["Total Revenue (KES)",a.totalRevenue.toFixed(2)],["Average Transaction (KES)",a.averageTransactionValue.toFixed(2)],["Revenue per User (KES)",a.totalUsers>0?(a.totalRevenue/a.totalUsers).toFixed(2):"0.00"]].map(g=>g.join(",")).join(`
`),f=new Blob([i],{type:"text/csv;charset=utf-8;"}),l=document.createElement("a");l.href=URL.createObjectURL(f),l.download=`mealpal-analytics-${N(new Date,"yyyy-MM-dd")}.csv`,l.click(),n.success("Report exported successfully!")};return b?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx("div",{className:"w-12 h-12 border-4 border-orange-500 border-t-transparent rounded-full animate-spin"})}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl",children:"System Analytics"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Overview of platform metrics"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(h,{variant:"outline",size:"sm",onClick:$,className:"gap-2",children:[e.jsx(ke,{className:"w-4 h-4"})," Refresh"]}),e.jsxs(h,{size:"sm",className:"bg-orange-500 hover:bg-orange-600 gap-2",onClick:T,children:[e.jsx(Re,{className:"w-4 h-4"})," Export Report"]})]})]}),e.jsxs(o,{children:[e.jsx(j,{children:e.jsx(u,{className:"text-base",children:"Date Range"})}),e.jsx(x,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs(O,{value:p,onValueChange:U,children:[e.jsx(z,{className:"w-full sm:w-[200px]",children:e.jsx(B,{placeholder:"Select range"})}),e.jsxs(V,{children:[e.jsx(c,{value:"all",children:"All Time"}),e.jsx(c,{value:"today",children:"Today"}),e.jsx(c,{value:"7days",children:"Last 7 Days"}),e.jsx(c,{value:"30days",children:"Last 30 Days"}),e.jsx(c,{value:"week",children:"This Week"}),e.jsx(c,{value:"month",children:"This Month"}),e.jsx(c,{value:"custom",children:"Custom Range"})]})]}),p==="custom"&&e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsxs(ne,{open:S,onOpenChange:D,children:[e.jsx(ce,{asChild:!0,children:e.jsxs(h,{variant:"outline",className:"gap-2 justify-start text-sm",children:[e.jsx(ie,{className:"w-4 h-4"}),r?N(r,"PP"):"Start Date"]})}),e.jsx(de,{className:"w-auto p-0",children:e.jsx(oe,{mode:"single",selected:r,onSelect:i=>{E(i),D(!1)}})})]}),e.jsxs(ne,{open:K,onOpenChange:C,children:[e.jsx(ce,{asChild:!0,children:e.jsxs(h,{variant:"outline",className:"gap-2 justify-start text-sm",children:[e.jsx(ie,{className:"w-4 h-4"}),m?N(m,"PP"):"End Date"]})}),e.jsx(de,{className:"w-auto p-0",children:e.jsx(oe,{mode:"single",selected:m,onSelect:i=>{q(i),C(!1)},disabled:i=>r?i<r:!1})})]})]})]})})]}),e.jsxs("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:[e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm",children:"Total Users"}),e.jsx(J,{className:"w-4 h-4 text-gray-500"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-orange-600",children:a.totalUsers}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Registered accounts"})]})]}),e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm",children:"Total Revenue"}),e.jsx(Me,{className:"w-4 h-4 text-gray-500"})]}),e.jsxs(x,{children:[e.jsxs("div",{className:"text-orange-600",children:["KES ",a.totalRevenue.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"All transactions"})]})]}),e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm",children:"Total Transactions"}),e.jsx($e,{className:"w-4 h-4 text-gray-500"})]}),e.jsxs(x,{children:[e.jsx("div",{className:"text-orange-600",children:a.totalTransactions}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Purchases made"})]})]}),e.jsxs(o,{children:[e.jsxs(j,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(u,{className:"text-sm",children:"Avg Transaction"}),e.jsx(Fe,{className:"w-4 h-4 text-gray-500"})]}),e.jsxs(x,{children:[e.jsxs("div",{className:"text-orange-600",children:["KES ",a.averageTransactionValue.toFixed(2)]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Per purchase"})]})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(o,{children:[e.jsxs(j,{children:[e.jsx(u,{children:"User Distribution"}),e.jsx(_,{children:"Breakdown of users by role"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{children:"Students"})]}),e.jsx("span",{className:"text-blue-600",children:a.totalStudents})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-purple-500"}),e.jsx("span",{children:"Cafeteria Admins"})]}),e.jsx("span",{className:"text-purple-600",children:a.totalCafeteriaAdmins})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsx("span",{children:"System Admins"})]}),e.jsx("span",{className:"text-red-600",children:a.totalSystemAdmins})]})]})]}),e.jsxs(o,{children:[e.jsxs(j,{children:[e.jsx(u,{children:"Platform Health"}),e.jsx(_,{children:"Key performance indicators"})]}),e.jsxs(x,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"User Engagement"}),e.jsxs("span",{children:[a.totalUsers>0?(a.totalTransactions/a.totalUsers*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 h-2 rounded-full",children:e.jsx("div",{className:"bg-orange-500 h-2 rounded-full",style:{width:`${Math.min(a.totalUsers>0?a.totalTransactions/a.totalUsers*100:0,100)}%`}})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Student Adoption"}),e.jsxs("span",{children:[a.totalUsers>0?(a.totalStudents/a.totalUsers*100).toFixed(1):0,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 h-2 rounded-full",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${a.totalUsers>0?a.totalStudents/a.totalUsers*100:0}%`}})})]}),e.jsx("div",{className:"pt-4 border-t",children:e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Revenue per User"}),e.jsxs("span",{className:"text-orange-600",children:["KES ",a.totalUsers>0?(a.totalRevenue/a.totalUsers).toFixed(2):"0.00"]})]})})]})]})]}),e.jsxs(o,{children:[e.jsxs(j,{children:[e.jsx(u,{children:"System Summary"}),e.jsx(_,{children:"Detailed platform statistics"})]}),e.jsx(x,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Active Students"}),e.jsx("p",{className:"text-orange-600",children:a.totalStudents})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Cafeteria Staff"}),e.jsx("p",{className:"text-orange-600",children:a.totalCafeteriaAdmins})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"System Administrators"}),e.jsx("p",{className:"text-orange-600",children:a.totalSystemAdmins})]})]})})]})]}):e.jsx(o,{children:e.jsx(x,{className:"py-12",children:e.jsx("p",{className:"text-center text-gray-500",children:"No analytics data available"})})})}function We({user:v,profile:a,accessToken:w,onSignOut:b}){const[y,p]=t.useState("users"),U=[{id:"users",label:"Users",icon:J},{id:"reports",label:"Reports",icon:Ie},{id:"profile",label:"Profile",icon:Le}];return e.jsxs("div",{className:"min-h-screen flex flex-col",children:[e.jsx("header",{className:"bg-white shadow-sm border-b sticky top-0 z-10",children:e.jsx("div",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"bg-orange-500 p-2 rounded-lg",children:e.jsx(ye,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg text-orange-600",children:"MealPal"}),e.jsx("p",{className:"text-xs text-gray-500",children:"System Admin"})]})]}),e.jsxs(we,{children:[e.jsx(be,{asChild:!0,children:e.jsx(h,{variant:"ghost",size:"sm",className:"md:hidden",children:e.jsx(Se,{className:"w-5 h-5"})})}),e.jsx(Ce,{children:e.jsxs("div",{className:"mt-8 space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Signed in as"}),e.jsx("p",{className:"font-medium",children:a.name}),e.jsx("p",{className:"text-sm text-gray-500",children:a.email})]}),e.jsxs(h,{onClick:b,variant:"outline",className:"w-full gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),"Sign Out"]})]})})]}),e.jsxs(h,{variant:"ghost",size:"sm",onClick:b,className:"hidden md:flex gap-2",children:[e.jsx(xe,{className:"w-4 h-4"}),"Sign Out"]})]})})}),e.jsx("main",{className:"flex-1 overflow-auto",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4 md:py-8",children:[y==="users"&&e.jsx(qe,{accessToken:w}),y==="reports"&&e.jsx(Ke,{accessToken:w}),y==="profile"&&e.jsx(Pe,{profile:a,accessToken:w})]})}),e.jsx("nav",{className:"fixed bottom-0 left-0 right-0 bg-white border-t shadow-lg md:hidden z-20",children:e.jsx("div",{className:"grid grid-cols-3",children:U.map(r=>{const E=r.icon,m=y===r.id;return e.jsxs("button",{onClick:()=>p(r.id),className:`flex flex-col items-center gap-1 py-3 px-2 transition-colors ${m?"text-orange-600 bg-orange-50":"text-gray-600 hover:text-orange-500"}`,children:[e.jsx(E,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:r.label})]},r.id)})})})]})}export{We as SystemAdminDashboard};
